<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Interpol Red Notices</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body { background: #0b0f1a; color: #e2e8f0; }
        .brand { color: #ff3b3b; letter-spacing: 1px; }
        .card { background: #111827; border: 1px solid #1f2937; }
        .card-title { color: #e5e7eb; }
        .badge-nation { background: #f59e0b; color: #111827; }
        .navbar-blur { backdrop-filter: blur(10px); background: rgba(17, 24, 39, 0.7); }
        .stats { color: #93c5fd; }
        .age-text { color: #ffffff; font-weight: 600; }
    </style>
    <meta http-equiv="refresh" content="30">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark navbar-blur border-bottom border-secondary sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand brand fw-bold" href="/">Interpol Red Notices</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav" aria-controls="nav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="nav">
      <form class="d-flex ms-auto" role="search" method="get">
        <input class="form-control me-2" type="search" placeholder="Ara: Ä°sim / Uyruk" aria-label="Search" name="q" value="{{ q or '' }}">
        <select class="form-select me-2" name="sort">
          <option value="name_asc"  {{ 'selected' if sort=='name_asc' else '' }}>Ä°sim Aâ†’Z</option>
          <option value="name_desc" {{ 'selected' if sort=='name_desc' else '' }}>Ä°sim Zâ†’A</option>
          <option value="id_desc"   {{ 'selected' if sort=='id_desc' else '' }}>Yeni â†’ Eski</option>
          <option value="id_asc"    {{ 'selected' if sort=='id_asc' else '' }}>Eski â†’ Yeni</option>
        </select>
        <select class="form-select me-2" name="per_page">
          <option value="20"  {{ 'selected' if per_page==20  else '' }}>20</option>
          <option value="50"  {{ 'selected' if per_page==50  else '' }}>50</option>
          <option value="100" {{ 'selected' if per_page==100 else '' }}>100</option>
        </select>
        <button class="btn btn-danger" type="submit">Uygula</button>
      </form>
    </div>
  </div>
</nav>

<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div class="stats">ðŸ“Š Toplam: {{ total_records }} | Sayfa {{ page }}/{{ total_pages }} | Son gÃ¼ncelleme: {{ current_time }}</div>
  </div>

  <div class="row g-3">
    {% for row in data %}
      {% set _id = row[0] %}
      {% set name = row[1] %}
      {% set age = row[2] %}
      {% set nationality = row[3] %}
      {% set updated_at = row[4] %}
      {% set updated_recent = row[5] %}
      <div class="col-12 col-sm-6 col-lg-4 col-xxl-3">
        <div class="card h-100 shadow-sm">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title mb-2">
              {{ name }}
              {% if updated_recent %}
                <span class="badge bg-warning text-dark ms-2">GÃ¼ncellendi</span>
              {% endif %}
            </h5>
            <p class="card-text mb-1 age-text">{{ age }}</p>
            <div>
              <span class="badge badge-nation">{{ nationality }}</span>
            </div>
            <div class="mt-auto pt-2 text-end">
              <span class="text-secondary">#{{ _id }}</span>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <nav class="mt-4" aria-label="Sayfalama">
    <ul class="pagination justify-content-center">
      <li class="page-item {{ 'disabled' if page <= 1 else '' }}">
        <a class="page-link" href="/?page={{ page - 1 if page>1 else 1 }}&per_page={{ per_page }}&q={{ q }}&sort={{ sort }}">Â« Ã–nceki</a>
      </li>
      <li class="page-item disabled"><a class="page-link" href="#">Sayfa {{ page }} / {{ total_pages }}</a></li>
      <li class="page-item {{ 'disabled' if page >= total_pages else '' }}">
        <a class="page-link" href="/?page={{ page + 1 if page<total_pages else total_pages }}&per_page={{ per_page }}&q={{ q }}&sort={{ sort }}">Sonraki Â»</a>
      </li>
    </ul>
  </nav>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>